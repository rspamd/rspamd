# Fuzzy check module configuration

min_bytes = 100;
timeout = 5s;
retransmits = 3;

rule "rspamd-integration" {
    algorithm = "mumhash";
    servers = "rspamd:50003";
    tcp = true;

    # Encryption settings
    encryption_key = "{= env.FUZZY_ENCRYPTION_KEY =}";

    # Fuzzy flags
    fuzzy_map = {
        FUZZY_SPAM {
            max_score = 10.0;
            flag = 1;
        }
        FUZZY_HAM {
            max_score = 5.0;
            flag = 2;
        }
    }

    min_length = 0;
    min_bytes = 0;
    read_only = false;
    skip_unknown = true;
}
